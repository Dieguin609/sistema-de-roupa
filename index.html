<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Loja de Roupas</title>
  <style>
    * {
      box-sizing: border-box;
      font-family: 'Segoe UI', sans-serif;
    }

    body {
      margin: 0;
      background: transparent;
      color: #fff;
      height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      overflow: hidden;
    }

    .container {
      display: flex;
      gap: 20px;
      width: 95%;
      max-width: 1400px;
      height: 90%;
      border-radius: 12px;
    }

    .sidebar, .details {
      width: 300px;
      background: rgba(20, 20, 30, 0.95);
      border: 2px solid #8a2be2;
      padding: 20px;
      border-radius: 12px;
      display: flex;
      flex-direction: column;
    }

    .sidebar h2 {
      margin: 0 0 20px;
      text-align: center;
      font-size: 28px;
      color: #bb88ff;
    }

    .tabs {
      display: flex;
      justify-content: space-between;
      margin-bottom: 20px;
    }

    .tab {
      background: #4a148c;
      padding: 8px 12px;
      border-radius: 6px;
      color: #fff;
      cursor: pointer;
      font-weight: bold;
      flex: 1;
      text-align: center;
      margin: 0 4px;
      border: 1px solid transparent;
    }

    .tab.active {
      background: #bb88ff;
      color: #2c003e;
      border-color: #ffdd33;
    }

    .item-list {
      flex: 1;
      overflow-y: auto;
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 12px;
    }

    .item {
      background: rgba(138, 43, 226, 0.1);
      border: 2px solid transparent;
      border-radius: 10px;
      text-align: center;
      padding: 10px;
      cursor: pointer;
      transition: 0.3s;
    }

    .item.selected {
      border-color: #ffdd33;
      background: rgba(255, 255, 255, 0.1);
    }

    .item:hover {
      background: rgba(255, 255, 255, 0.08);
      border-color: #bb88ff;
    }

    .item img {
      width: 80px;
      height: 80px;
      object-fit: contain;
      margin-bottom: 6px;
    }

    .preview {
      flex: 1;
      pointer-events: none;
    }

    .details h3 {
      margin: 0;
      color: #ffdd33;
    }

    .details p {
      margin: 8px 0;
      color: #ddd;
    }

    .total {
      margin-top: auto;
      border-top: 1px solid #444;
      padding-top: 15px;
      font-size: 18px;
      color: #ffdd33;
    }

    .actions {
      display: flex;
      gap: 10px;
      margin-top: 20px;
    }

    button {
      flex: 1;
      padding: 12px;
      border: none;
      border-radius: 6px;
      font-weight: bold;
      font-size: 15px;
      cursor: pointer;
      background: #bb88ff;
      color: #2c003e;
      transition: 0.3s;
    }

    button:hover {
      background: #ffdd33;
      color: #000;
    }

    button:disabled {
      background: #999;
      cursor: not-allowed;
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="sidebar">
      <h2>Loja de Roupas</h2>
      <div class="tabs">
        <div class="tab active" data-tab="camisas">Camisas</div>
        <div class="tab" data-tab="shorts">Shorts</div>
        <div class="tab" data-tab="acessorios">Acessórios</div>
      </div>
      <div class="item-list" id="item-list"></div>
    </div>

    <div class="preview"></div>

    <div class="details">
      <h3 id="item-title">Selecione um item</h3>
      <p id="item-desc">Descrição do item aparecerá aqui.</p>
      <p><strong>Preço:</strong> <span id="item-price">R$ 0</span></p>
      <div class="total">
        Total da Sacola: R$ <span id="cart-total">0</span>
      </div>
      <div class="actions">
        <button id="buy-btn" disabled>Comprar</button>
        <button id="cancel-btn">Cancelar</button>
      </div>
    </div>
  </div>

  <script>
    const dadosItens = {
      camisas: [
        {
          id: 'camisa1',
          nome: 'Brasil',
          descricao: 'Camisa do Brasil azul com design clássico.',
          preco: 15000,
          dffs: ['wbdyg1', 'wmybmx'],
          png: 'camisa1.png'
        },
        {
          id: 'camisa2',
          nome: 'Falamengo',
          descricao: 'Camisa do Flamengo oficial.',
          preco: 18000,
          dffs: ['bmost', 'bmyri'],
          png: 'camisa2.png'
        }
      ],
      shorts: [
        {
          id: 'short1',
          nome: 'Short Azul Brasil',
          descricao: 'Short que combina com a Camisa do Brasil Azul.',
          preco: 7000,
          dffs: ['wbdyg1'],
          png: 'short1.png'
        },
        {
          id: 'short2',
          nome: 'Short Preto Brasil',
          descricao: 'Outra opção de short para a Camisa do Brasil Azul.',
          preco: 9000,
          dffs: ['wmybmx'],
          png: 'short2.png'
        },
        {
          id: 'short3',
          nome: 'Short Flamengo 1',
          descricao: 'Short para combinar com a camisa do Flamengo.',
          preco: 8000,
          dffs: ['bmost'],
          png: 'short3.png'
        },
        {
          id: 'short4',
          nome: 'Short Flamengo 2',
          descricao: 'Outra opção de short para o Flamengo.',
          preco: 8500,
          dffs: ['bmyri'],
          png: 'short4.png'
        }
      ],
      acessorios: []
    };

    let abaAtiva = 'camisas';
    let camisaSelecionada = null;
    let shortSelecionado = null;

    const itemList = document.getElementById('item-list');
    const itemTitle = document.getElementById('item-title');
    const itemDesc = document.getElementById('item-desc');
    const itemPrice = document.getElementById('item-price');
    const cartTotal = document.getElementById('cart-total');
    const buyBtn = document.getElementById('buy-btn');
    const cancelBtn = document.getElementById('cancel-btn');

    function carregarItens(aba) {
      itemList.innerHTML = '';
      buyBtn.disabled = true;
      itemTitle.textContent = 'Selecione um item';
      itemDesc.textContent = 'Descrição do item aparecerá aqui.';
      itemPrice.textContent = 'R$ 0';

      let itens = dadosItens[aba] || [];

      if (aba === 'shorts' && camisaSelecionada) {
        itens = itens.filter(short => short.dffs.some(dff => camisaSelecionada.dffs.includes(dff)));
      }

      if (aba === 'shorts' && !camisaSelecionada) {
        itemList.innerHTML = '<p style="grid-column: span 2; color: #ffdd33;">Selecione uma camisa primeiro</p>';
        return;
      }

      itens.forEach(item => {
        const div = document.createElement('div');
        div.className = 'item';
        div.innerHTML = `
          <img src="${item.png}" alt="${item.nome}">
          <div><strong>${item.nome}</strong></div>
          <div>R$ ${item.preco.toLocaleString()}</div>
        `;
        div.onclick = () => selecionarItem(item, div);
        itemList.appendChild(div);
      });
    }

    function selecionarItem(item, div) {
      document.querySelectorAll('.item').forEach(i => i.classList.remove('selected'));
      div.classList.add('selected');

      itemTitle.textContent = item.nome;
      itemDesc.textContent = item.descricao;
      itemPrice.textContent = `R$ ${item.preco.toLocaleString()}`;
      buyBtn.disabled = false;

      if (abaAtiva === 'camisas') {
        camisaSelecionada = item;
        shortSelecionado = null;
      } else if (abaAtiva === 'shorts') {
        shortSelecionado = item;
      }

      atualizarTotal();
    }

    function atualizarTotal() {
      let total = 0;
      if (camisaSelecionada) total += camisaSelecionada.preco;
      if (shortSelecionado) total += shortSelecionado.preco;
      cartTotal.textContent = total.toLocaleString();
    }

    document.querySelectorAll('.tab').forEach(tab => {
      tab.onclick = () => {
        document.querySelector('.tab.active').classList.remove('active');
        tab.classList.add('active');
        abaAtiva = tab.dataset.tab;
        carregarItens(abaAtiva);
      };
    });

    buyBtn.onclick = () => {
      if (!camisaSelecionada || !shortSelecionado) {
        alert("Selecione uma camisa e um short!");
        return;
      }

      const data = `${camisaSelecionada.id}|${shortSelecionado.dffs[0]}`;
      if (typeof cef !== 'undefined' && cef.emit) {
        cef.emit("loja_evento", data);
        cef.emit("loja_evento", "fechar_loja");
        cef.emit("loja_evento", "mouse_off");
      }
    };

    cancelBtn.onclick = () => {
      if (typeof cef !== 'undefined' && cef.emit) {
        cef.emit("loja_evento", "fechar_loja");
        cef.emit("loja_evento", "mouse_off");
      }
    };

    carregarItens(abaAtiva);
  </script>
</body>
</html>
